# Request Tracker

Create badges for present view count of your webpages.

<table>
  <tr>
    <td>
      <a href="https://github.com/femrek/request-tracker">
        <img src="https://request-tracker.femrek.me/api/subscriptions/request/badge/36aadabd-2fab-49fc-bc63-59a4ff5ec354?label=View%20Count" alt="View Count Badge" />
      </a>
    </td>
    <td>Main export of the project</td>
  </tr>
  <tr>
    <td>
      <a href="https://request-tracker.femrek.me/">
        <img src="https://img.shields.io/badge/dynamic/json?url=https%3A%2F%2Frequest-tracker.femrek.me%2Factuator%2Fhealth&query=%24.status&label=Live%20Site&color=DarkGreen" alt="Live Site Badge" />
      </a>
    </td>
    <td>Live website â€” You can create your own</td>
  </tr>
</table>

![req-tra-demo-low-res](https://github.com/user-attachments/assets/22f71ba5-ccdc-4486-9da7-3f50c72f1813)

## Run The Application

Clone the project

```bash
  git clone git@github.com:femrek/request-tracker.git
```

Go to the project directory

```bash
  cd request-tracker
```

Create GitHub OAuth2 app.

1. Create a GitHub OAuth2 application. https://github.com/settings/developers. Then, create a secret.
2. Enter your apps information (`GITHUB_CLIENT_ID` and `GITHUB_CLIENT_SECRET`) into `.env` or `.env.properties` files.

#### a. For Docker Run

Create JAR file

```bash
  ./mwnw clean package
```

Create `.env` file. (lines starting with # are optional)

```env
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

SPRING_PORT=8181

SHIELD_URL=http://shield:80

POSTGRES_PASSWORD=
POSTGRES_HOST=db
#POSTGRES_DB=

#REQUEST_TRACKER_URL=
```

Run docker compose

```bash
  docker compose up
```

#### b. For Native Run (only the Spring app runs natively)

Create `.env.properties` file to configure spring app.

```env
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

SPRING_PORT=8181

POSTGRES_PASSWORD=
POSTGRES_HOST=db
#POSTGRES_DB=

#SHIELD_URL=http://localhost:8380

#REQUEST_TRACKER_URL=
```

Run Postgres and Shield

```bash
docker compose up db shield
```

Run the application

```bash
./mwnw spring-boot:run
```

## After Run

1. Connect the application (`localhost:8181` by default).
2. Login via GitHub.
3. Create a new subscription with the button in the subscriptions section.
4. Copy one of the links and try to connect. (counter must be increased after connection)

## API Reference

The app is built as MVC app. But, for embed the service to webpages, following end-points exist.

#### Get Subscription Data (includes count)

```http
  GET /request/{uuid}
```

Increases the counter of the subscription by one and responds with the new subscription.

```http
  GET /no-request/{uuid}
```

Returns the subscription without increasing the counter.

| Parameter | Type     | Description                                      |
|:----------|:---------|:-------------------------------------------------|
| `uuid`    | `string` | **Required**. The id of the related subscription |

Return json in form of following example.

```json
{
  "id": "0e9a0a0a-40af-4361-a205-67ab239ec368",
  "name": "Subscription Name",
  "count": 42,
  "restEndpoint": "/api/subscriptions/request/0e9a0a0a-40af-4361-a205-67ab239ec368",
  "svgEndpoint": "/api/subscriptions/request/badge/0e9a0a0a-40af-4361-a205-67ab239ec368",
  "createdAt": "2025-07-08T18:15:30.012+00:00"
}
```

#### Get Badge

```http
  GET /request/badge/{uuid}?label=Views&color=blue
```

Increases the counter of the subscription by one and responds shield image as svg.

```http
  GET /no-request/badge/{uuid}?label=Views&color=blue
```

Returns the shield image as svg without increasing the counter.

| Parameter | Type     | Description                                      |
|:----------|:---------|:-------------------------------------------------|
| `uuid`    | `string` | **Required**. The id of the related subscription |

| Get Parameter | Type     | Description                                                |
|:--------------|:---------|:-----------------------------------------------------------|
| `label`       | `string` | **Optional**. The text shown at the left side of the badge |
| `color`       | `color`  | **Optional**. The color of the right sid of the badge      |

**Note:** all shield static parameters are allowed. Can generate query [here](https://shields.io/badges/static-badge).

Returns svg image. (generated by [shield](https://github.com/badges/shields))

## Technologies Used

- [Spring Boot](https://spring.io/projects/spring-boot)
- [PostgreSQL](https://www.postgresql.org/)
- [Shield](https://github.com/badges/shields)
